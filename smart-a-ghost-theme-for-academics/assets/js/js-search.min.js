"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.JsSearch=t():(void 0).JsSearch=t()}(0,function(){return o={},r.m=n=[function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return r.AllSubstringsIndexStrategy}});var o=n(9);Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return o.ExactWordIndexStrategy}});var i=n(10);Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return i.PrefixIndexStrategy}})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return r.CaseSensitiveSanitizer}});var o=n(12);Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return o.LowerCaseSanitizer}})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(13);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return r.TfIdfSearchIndex}});var o=n(14);Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return o.UnorderedSearchIndex}})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=t.StopWordsMap={a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,do:!0,does:!0,either:!0,else:!0,ever:!0,every:!0,for:!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,if:!0,in:!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,this:!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,while:!0,who:!0,whom:!0,why:!0,will:!0,with:!0,would:!0,yet:!0,you:!0,your:!0};r.constructor=!1,r.hasOwnProperty=!1,r.isPrototypeOf=!1,r.propertyIsEnumerable=!1,r.toLocaleString=!1,r.toString=!1,r.valueOf=!1},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return r.SimpleTokenizer}});var o=n(16);Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return o.StemmingTokenizer}});var i=n(17);Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return i.StopWordsTokenizer}})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=t||[];for(var n=e=e||{},r=0;r<t.length;r++)if(null==(n=n[t[r]]))return null;return n}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var r,o=function(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e},i=n(5),x=(r=i)&&r.__esModule?r:{default:r},a=n(0),u=n(1),c=n(2),f=n(4);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),!e)throw Error("js-search requires a uid field name constructor parameter");this._uidFieldName=e,this._indexStrategy=new a.PrefixIndexStrategy,this._searchIndex=new c.TfIdfSearchIndex(e),this._sanitizer=new u.LowerCaseSanitizer,this._tokenizer=new f.SimpleTokenizer,this._documents=[],this._searchableFields=[]}t.Search=(o(s,[{key:"addDocument",value:function(e){this.addDocuments([e])}},{key:"addDocuments",value:function(e){this._documents=this._documents.concat(e),this.indexDocuments_(e,this._searchableFields)}},{key:"addIndex",value:function(e){this._searchableFields.push(e),this.indexDocuments_(this._documents,[e])}},{key:"search",value:function(e){var t=this._tokenizer.tokenize(this._sanitizer.sanitize(e));return this._searchIndex.search(t,this._documents)}},{key:"indexDocuments_",value:function(e,t){this._initialized=!0;for(var n=this._indexStrategy,r=this._sanitizer,o=this._searchIndex,i=this._tokenizer,a=this._uidFieldName,u=0,c=e.length;u<c;u++){var f,l=e[u];f=a instanceof Array?(0,x.default)(l,a):l[a];for(var s=0,d=t.length;s<d;s++){var h,y=t[s];if(null!=(h=y instanceof Array?(0,x.default)(l,y):l[y])&&"string"!=typeof h&&h.toString&&(h=h.toString()),"string"==typeof h)for(var p=i.tokenize(r.sanitize(h)),b=0,v=p.length;b<v;b++)for(var m=p[b],g=n.expandToken(m),_=0,S=g.length;_<S;_++){var k=g[_];o.indexDocument(k,f,l)}}}}},{key:"indexStrategy",set:function(e){if(this._initialized)throw Error("IIndexStrategy cannot be set after initialization");this._indexStrategy=e},get:function(){return this._indexStrategy}},{key:"sanitizer",set:function(e){if(this._initialized)throw Error("ISanitizer cannot be set after initialization");this._sanitizer=e},get:function(){return this._sanitizer}},{key:"searchIndex",set:function(e){if(this._initialized)throw Error("ISearchIndex cannot be set after initialization");this._searchIndex=e},get:function(){return this._searchIndex}},{key:"tokenizer",set:function(e){if(this._initialized)throw Error("ITokenizer cannot be set after initialization");this._tokenizer=e},get:function(){return this._tokenizer}}]),s)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenHighlighter=void 0;var r=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e},o=n(0),i=n(1);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,u),this._indexStrategy=e||new o.PrefixIndexStrategy,this._sanitizer=t||new i.LowerCaseSanitizer,this._wrapperTagName=n||"mark"}t.TokenHighlighter=(r(u,[{key:"highlight",value:function(e,t){for(var n=this._wrapText("").length,r=Object.create(null),o=0,i=t.length;o<i;o++)for(var a=this._sanitizer.sanitize(t[o]),u=this._indexStrategy.expandToken(a),c=0,f=u.length;c<f;c++){var l=u[c];r[l]?r[l].push(a):r[l]=[a]}for(var s="",d="",h=0,y=(o=0,e.length);o<y;o++){var p=e.charAt(o);" "===p?(d=s="",h=o+1):(s+=p,d+=this._sanitizer.sanitize(p)),r[d]&&0<=r[d].indexOf(d)&&(s=this._wrapText(s),e=e.substring(0,h)+s+e.substring(o+1),o+=n,y+=n)}return e}},{key:"_wrapText",value:function(e){var t=this._wrapperTagName;return"<"+t+">"+e+"</"+t+">"}}]),u)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}t.AllSubstringsIndexStrategy=(r(i,[{key:"expandToken",value:function(e){for(var t,n=[],r=0,o=e.length;r<o;++r){t="";for(var i=r;i<o;++i)t+=e.charAt(i),n.push(t)}return n}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}t.ExactWordIndexStrategy=(r(i,[{key:"expandToken",value:function(e){return e?[e]:[]}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}t.PrefixIndexStrategy=(r(i,[{key:"expandToken",value:function(e){for(var t=[],n="",r=0,o=e.length;r<o;++r)n+=e.charAt(r),t.push(n);return t}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}t.CaseSensitiveSanitizer=(r(i,[{key:"sanitize",value:function(e){return e?e.trim():""}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}t.LowerCaseSanitizer=(r(i,[{key:"sanitize",value:function(e){return e?e.toLocaleLowerCase().trim():""}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TfIdfSearchIndex=void 0;var r,h="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},o=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e},i=n(5),d=(r=i)&&r.__esModule?r:{default:r};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,u),this._uidFieldName=e,this._tokenToIdfCache={},this._tokenMap={}}t.TfIdfSearchIndex=(o(u,[{key:"indexDocument",value:function(e,t,n){this._tokenToIdfCache={};var r,o=this._tokenMap;"object"!==h(o[e])?o[e]=r={$numDocumentOccurrences:0,$totalNumOccurrences:1,$uidMap:{}}:(r=o[e]).$totalNumOccurrences++;var i=r.$uidMap;"object"!==h(i[t])?(r.$numDocumentOccurrences++,i[t]={$document:n,$numTokenOccurrences:1}):i[t].$numTokenOccurrences++}},{key:"search",value:function(n,r){for(var e={},t=0,o=n.length;t<o;t++){var i,a=n[t],u=this._tokenMap[a];if(!u)return[];if(0===t)for(var c=0,f=(i=Object.keys(u.$uidMap)).length;c<f;c++)e[l=i[c]]=u.$uidMap[l].$document;else for(c=0,f=(i=Object.keys(e)).length;c<f;c++){var l=i[c];"object"!==h(u.$uidMap[l])&&delete e[l]}}var s=[];for(var l in e)s.push(e[l]);var d=this._createCalculateTfIdf();return s.sort(function(e,t){return d(n,t,r)-d(n,e,r)})}},{key:"_createCalculateIdf",value:function(){var r=this._tokenMap,o=this._tokenToIdfCache;return function(e,t){if(!o[e]){var n=void 0!==r[e]?r[e].$numDocumentOccurrences:0;o[e]=1+Math.log(t.length/(1+n))}return o[e]}}},{key:"_createCalculateTfIdf",value:function(){var f=this._tokenMap,l=this._uidFieldName,s=this._createCalculateIdf();return function(e,t,n){for(var r=0,o=0,i=e.length;o<i;++o){var a,u=e[o],c=s(u,n);c===1/0&&(c=0),a=l instanceof Array?t&&(0,d.default)(t,l):t&&t[l],r+=(void 0!==f[u]&&void 0!==f[u].$uidMap[a]?f[u].$uidMap[a].$numTokenOccurrences:0)*c}return r}}}]),u)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this._tokenToUidToDocumentMap={}}t.UnorderedSearchIndex=(r(i,[{key:"indexDocument",value:function(e,t,n){"object"!==d(this._tokenToUidToDocumentMap[e])&&(this._tokenToUidToDocumentMap[e]={}),this._tokenToUidToDocumentMap[e][t]=n}},{key:"search",value:function(e,t){for(var n={},r=this._tokenToUidToDocumentMap,o=0,i=e.length;o<i;o++){var a=r[e[o]];if(!a)return[];if(0===o)for(var u=0,c=(l=Object.keys(a)).length;u<c;u++)n[f=l[u]]=a[f];else for(u=0,c=(l=Object.keys(n)).length;u<c;u++){var f=l[u];"object"!==d(a[f])&&delete n[f]}}var l,s=[];for(o=0,c=(l=Object.keys(n)).length;o<c;o++)f=l[o],s.push(n[f]);return s}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},o=/[^a-zа-яё0-9\-']+/i;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}t.SimpleTokenizer=(r(a,[{key:"tokenize",value:function(e){return e.split(o).filter(function(e){return e})}}]),a)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this._stemmingFunction=e,this._tokenizer=t}t.StemmingTokenizer=(r(i,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).map(this._stemmingFunction)}}]),i)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.StopWordsTokenizer=void 0;var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},o=n(3);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this._tokenizer=e}t.StopWordsTokenizer=(r(a,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).filter(function(e){return!o.StopWordsMap[e]})}}]),a)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return r.AllSubstringsIndexStrategy}}),Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return r.ExactWordIndexStrategy}}),Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return r.PrefixIndexStrategy}});var o=n(1);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return o.CaseSensitiveSanitizer}}),Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return o.LowerCaseSanitizer}});var i=n(2);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return i.TfIdfSearchIndex}}),Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return i.UnorderedSearchIndex}});var a=n(4);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return a.SimpleTokenizer}}),Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return a.StemmingTokenizer}}),Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return a.StopWordsTokenizer}});var u=n(6);Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return u.Search}});var c=n(3);Object.defineProperty(t,"StopWordsMap",{enumerable:!0,get:function(){return c.StopWordsMap}});var f=n(7);Object.defineProperty(t,"TokenHighlighter",{enumerable:!0,get:function(){return f.TokenHighlighter}})}],r.c=o,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=18);function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,o});